---
import { getUILabel, DEFAULT_LANGUAGE } from '../lib/i18n'
import SearchFilter from './SearchFilter.astro'

export interface Props {
  lang?: string
}

const { lang = DEFAULT_LANGUAGE } = Astro.props

const title = getUILabel(lang, 'heroTitle')
const subtitle = getUILabel(lang, 'heroSubtitle')
const ctaText = getUILabel(lang, 'readStories')
---

<section class="relative overflow-hidden min-h-[38vh] md:min-h-[52vh] flex items-start justify-center bg-white pt-8 pb-6 md:pt-24 md:pb-24">
  <div class="absolute top-1/2 left-1/2 transform -translate-x-[62%] -translate-y-1/2 pointer-events-none hinomaru-container">
    <div class="w-full h-full rounded-full hinomaru-circle"></div>
  </div>
  <!-- Soft fade on the right to blend character and background -->
  <div class="absolute inset-y-0 right-0 w-40 md:w-56 bg-gradient-to-l from-white to-transparent pointer-events-none"></div>
  
  <!-- 秀歌 character image - positioned to avoid overlaps -->
  <!-- Character moved to global floating assistant (see Layout.astro) -->

  <!-- Fade to white at bottom -->
  <div class="absolute inset-x-0 bottom-0 h-24 bg-gradient-to-t from-white to-transparent pointer-events-none z-5"></div>

  <!-- Content with entrance animations -->
  <div class="relative max-w-5xl mx-auto px-4 text-center z-10 mt-6 md:mt-12">
    <h1 class="text-4xl md:text-6xl font-semibold tracking-wide text-gray-900 mb-4 drop-shadow-sm hero-title animate-fade-in-up">
      {title}
    </h1>
    <p class="mt-2 text-base md:text-lg text-gray-600 max-w-3xl mx-auto leading-relaxed drop-shadow-sm hero-subtitle animate-fade-in-up-delay mb-4 md:mb-16">
      {subtitle}
    </p>
    
    <!-- Search Filter with proper spacing -->
    <div class="relative z-20 animate-fade-in-up-delay-2">
      <div class="max-w-4xl mx-auto">
        <SearchFilter lang={lang} />
      </div>
    </div>
  </div>
</section>

<style>
  /* Responsive Hinomaru container */
  .hinomaru-container {
    width: 95vw;
    height: 95vw;
    max-width: 880px;
    max-height: 880px;
  }
  
  /* Hinomaru-inspired solid circle with soft edge */
  .hinomaru-circle {
    /* Softer abstract circle, slightly left of center */
    background: radial-gradient(circle at 45% 50%, var(--theme-accent-weak) 0%, var(--theme-accent-weak) 55%, var(--theme-accent-fade) 75%, transparent 100%);
    filter: blur(0.5px);
    opacity: 0.75;
  }

  @media (prefers-reduced-motion: reduce) {
    * {
      animation: none !important;
    }
  }
  
  @keyframes spin-slow {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
  }
  
  @keyframes dash {
    0% { stroke-dashoffset: 0; }
    100% { stroke-dashoffset: 20; }
  }
  
  .animate-spin-slow {
    animation: spin-slow 60s linear infinite;
  }
  
  .animate-dash {
    animation: dash 3s linear infinite;
  }
  
  /* Japanese typography for hero section */
  .hero-title {
    font-family: 'Shippori Mincho', 'Noto Serif JP', serif;
    text-rendering: optimizeLegibility;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }
  
  .hero-subtitle {
    font-family: 'Shippori Mincho', 'Noto Serif JP', serif;
    text-rendering: optimizeLegibility;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }
  
  /* 秀歌 Character Styling */
  .shuuka-container {
    filter: drop-shadow(0 8px 20px rgba(0, 0, 0, 0.1));
    z-index: 15;
  }
  
  .shuuka-image {
    transition: all 0.3s ease;
    filter: brightness(1.05) contrast(1.1) saturate(1.1);
  }
  
  /* Enhanced hover effects for clickable character */
  .shuuka-link:hover .shuuka-image {
    transform: scale(1.05) translateY(-4px);
    filter: brightness(1.15) contrast(1.2) saturate(1.3);
  }
  
  .shuuka-link:hover .shuuka-glow {
    opacity: 0.8;
    scale: 1.3;
    background: radial-gradient(circle, var(--theme-accent)/25 0%, var(--theme-accent)/10 50%, transparent 100%);
  }
  
  .shuuka-link:active .shuuka-image {
    transform: scale(1.02) translateY(-2px);
  }
  
  /* External link icon styling */
  .external-link-icon {
    backdrop-filter: blur(4px);
    border: 1px solid var(--theme-accent)/20;
  }
  
  .external-link-icon:hover {
    background: white;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  }
  
  .speech-bubble {
    animation: float 3s ease-in-out infinite;
    transform-origin: bottom center;
  }
  
  @keyframes float {
    0%, 100% { 
      transform: translateY(0px) rotate(0deg); 
    }
    50% { 
      transform: translateY(-3px) rotate(1deg); 
    }
  }
  
  /* Enhanced Responsive Design - Optimized for harmony */
  
  /* Extra Large screens (1536px+) */
  @media (min-width: 1536px) {
    .shuuka-container {
      right: 4rem;
      top: 1.5rem;
    }
    
    .shuuka-image {
      width: 12rem; /* Slightly smaller to prevent crowding */
    }
    
    .speech-bubble {
      left: -3rem;
      top: 2.5rem;
      padding: 0.625rem 0.875rem;
    }
    
    .speech-bubble span {
      font-size: 0.8125rem;
    }
  }
  
  /* Large screens (1024px - 1535px) */
  @media (min-width: 1024px) and (max-width: 1535px) {
    .shuuka-container {
      right: 3rem;
      top: 2rem;
    }
    
    .shuuka-image {
      width: 10rem; /* Balanced size for large screens */
    }
    
    .speech-bubble {
      left: -2.5rem;
      top: 2rem;
      padding: 0.5rem 0.75rem;
    }
    
    .speech-bubble span {
      font-size: 0.75rem;
    }
  }
  
  /* Medium screens (768px - 1023px) - Hidden to prevent overlap */
  @media (min-width: 768px) and (max-width: 1023px) {
    .shuuka-container {
      display: none; /* Hide on medium screens to prevent text overlap */
    }
  }
  
  /* Small tablets (640px - 767px) - Also hidden */
  @media (min-width: 640px) and (max-width: 767px) {
    .shuuka-container {
      display: none; /* Hide on small tablets too */
    }
  }
  
  /* Mobile landscape (481px - 639px) - Hidden */
  @media (min-width: 481px) and (max-width: 639px) {
    .shuuka-container {
      display: none;
    }
  }
  
  /* Mobile portrait (320px - 480px) */
  @media (max-width: 480px) {
    .shuuka-container {
      display: none; /* Hide on very small screens to avoid clutter */
    }
    
    /* Adjust hero content for mobile */
    .hero-title {
      font-size: 2rem !important;
      line-height: 1.2;
    }
    
    .hero-subtitle {
      font-size: 0.875rem !important;
      line-height: 1.4;
    }
  }
  
  /* Ultra-wide screens (1920px+) */
  @media (min-width: 1920px) {
    .hinomaru-container {
      max-width: 1200px;
      max-height: 1200px;
    }
    
    .shuuka-container {
      right: 6rem;
      top: 1rem;
    }
    
    .shuuka-image {
      width: 14rem;
    }
    
    .speech-bubble {
      left: -4rem;
      top: 3rem;
    }
  }
  
  /* Height-based responsive adjustments */
  @media (max-height: 600px) {
    .shuuka-container {
      top: 1rem !important;
      right: 2rem !important;
    }
    
    .shuuka-image {
      width: 6rem !important;
    }
    
    .speech-bubble {
      display: none !important; /* Hide speech bubble on short screens */
    }
    
    section {
      min-height: 70vh !important;
    }
  }
  
  /* High density displays */
  @media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
    .shuuka-image {
      image-rendering: -webkit-optimize-contrast;
      image-rendering: crisp-edges;
    }
  }
  
  /* Touch device optimizations */
  @media (hover: none) and (pointer: coarse) {
    .shuuka-image:hover {
      transform: none;
      filter: brightness(1.05) contrast(1.1) saturate(1.1);
    }
    
    .speech-bubble {
      animation-duration: 4s; /* Slower animation for touch devices */
    }
  }

  /* Hero Animation Keyframes */
  @keyframes breathe {
    0%, 100% { 
      transform: scale(1) rotate(0deg); 
      opacity: 0.75;
    }
    50% { 
      transform: scale(1.08) rotate(2deg); 
      opacity: 0.9;
    }
  }
  
  @keyframes float-big-1 {
    0%, 100% { 
      transform: translateY(0px) translateX(0px) rotate(0deg) scale(1); 
      opacity: 0.8;
    }
    25% { 
      transform: translateY(-25px) translateX(15px) rotate(90deg) scale(1.1); 
      opacity: 1;
    }
    50% { 
      transform: translateY(-40px) translateX(30px) rotate(180deg) scale(1.2); 
      opacity: 0.9;
    }
    75% { 
      transform: translateY(-20px) translateX(15px) rotate(270deg) scale(1.05); 
      opacity: 0.95;
    }
  }
  
  @keyframes float-big-2 {
    0%, 100% { 
      transform: translateY(0px) translateX(0px) rotate(0deg) scale(1); 
      opacity: 0.7;
    }
    33% { 
      transform: translateY(-30px) translateX(-20px) rotate(120deg) scale(1.15); 
      opacity: 1;
    }
    66% { 
      transform: translateY(-50px) translateX(-35px) rotate(240deg) scale(1.3); 
      opacity: 0.85;
    }
  }
  
  @keyframes float-big-3 {
    0%, 100% { 
      transform: translateY(0px) translateX(0px) rotate(0deg) scale(1); 
      opacity: 0.6;
    }
    40% { 
      transform: translateY(35px) translateX(-25px) rotate(144deg) scale(1.2); 
      opacity: 0.9;
    }
    80% { 
      transform: translateY(60px) translateX(-40px) rotate(288deg) scale(1.4); 
      opacity: 1;
    }
  }
  
  @keyframes wave-1 {
    0%, 100% { 
      transform: translateY(0px) translateX(0px) rotate(45deg) scaleY(1);
    }
    50% { 
      transform: translateY(-40px) translateX(20px) rotate(225deg) scaleY(1.5);
    }
  }
  
  @keyframes wave-2 {
    0%, 100% { 
      transform: translateY(0px) translateX(0px) rotate(0deg) scaleX(1);
    }
    50% { 
      transform: translateY(30px) translateX(-30px) rotate(180deg) scaleX(1.8);
    }
  }
  
  @keyframes spin-wave {
    0% { 
      transform: translateY(0px) translateX(0px) rotate(45deg) scale(1);
    }
    25% { 
      transform: translateY(-15px) translateX(15px) rotate(135deg) scale(1.3);
    }
    50% { 
      transform: translateY(-25px) translateX(25px) rotate(225deg) scale(1.5);
    }
    75% { 
      transform: translateY(-15px) translateX(15px) rotate(315deg) scale(1.2);
    }
    100% { 
      transform: translateY(0px) translateX(0px) rotate(405deg) scale(1);
    }
  }
  
  @keyframes glow-pulse {
    0%, 100% { 
      opacity: 0.6; 
      transform: scale(1);
      box-shadow: 0 0 5px currentColor;
    }
    50% { 
      opacity: 1; 
      transform: scale(1.8);
      box-shadow: 0 0 20px currentColor, 0 0 30px currentColor;
    }
  }
  
  @keyframes glow-pulse-2 {
    0%, 100% { 
      opacity: 0.7; 
      transform: scale(1);
      box-shadow: 0 0 3px currentColor;
    }
    50% { 
      opacity: 1; 
      transform: scale(2.2);
      box-shadow: 0 0 15px currentColor, 0 0 25px currentColor;
    }
  }
  
  @keyframes glow-pulse-3 {
    0%, 100% { 
      opacity: 0.5; 
      transform: scale(1);
      box-shadow: 0 0 8px currentColor;
    }
    50% { 
      opacity: 1; 
      transform: scale(2);
      box-shadow: 0 0 25px currentColor, 0 0 40px currentColor;
    }
  }
  
  @keyframes sparkle-1 {
    0%, 100% { 
      transform: translateY(0px) rotate(0deg) scale(0);
      opacity: 0;
    }
    20% { 
      transform: translateY(-10px) rotate(90deg) scale(1);
      opacity: 1;
    }
    80% { 
      transform: translateY(-30px) rotate(270deg) scale(1.2);
      opacity: 0.8;
    }
  }
  
  @keyframes sparkle-2 {
    0%, 100% { 
      transform: translateY(0px) rotate(0deg) scale(0);
      opacity: 0;
    }
    25% { 
      transform: translateY(15px) rotate(180deg) scale(1.1);
      opacity: 1;
    }
    75% { 
      transform: translateY(40px) rotate(360deg) scale(1.3);
      opacity: 0.9;
    }
  }
  
  @keyframes sparkle-3 {
    0%, 100% { 
      transform: translateY(0px) rotate(0deg) scale(0);
      opacity: 0;
    }
    30% { 
      transform: translateY(-20px) rotate(45deg) scale(1);
      opacity: 1;
    }
    70% { 
      transform: translateY(-50px) rotate(405deg) scale(1.4);
      opacity: 0.7;
    }
  }
  
  @keyframes drift-1 {
    0%, 100% { 
      transform: translateY(0px) translateX(0px) rotate(45deg); 
    }
    50% { 
      transform: translateY(-20px) translateX(10px) rotate(225deg); 
    }
  }
  
  @keyframes drift-2 {
    0%, 100% { 
      transform: translateY(0px) translateX(0px) rotate(0deg); 
    }
    50% { 
      transform: translateY(15px) translateX(-15px) rotate(180deg); 
    }
  }
  
  @keyframes drift-3 {
    0%, 100% { 
      transform: translateY(0px) translateX(0px) rotate(45deg); 
    }
    50% { 
      transform: translateY(25px) translateX(20px) rotate(405deg); 
    }
  }
  
  @keyframes pulse-gentle {
    0%, 100% { 
      opacity: 0.3; 
      transform: scale(1);
    }
    50% { 
      opacity: 0.7; 
      transform: scale(1.1);
    }
  }
  
  @keyframes fade-in-up {
    0% {
      opacity: 0;
      transform: translateY(30px);
    }
    100% {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* Animation Classes */
  .animate-breathe {
    animation: breathe 6s ease-in-out infinite;
  }
  
  .animate-float-big-1 {
    animation: float-big-1 8s ease-in-out infinite;
  }
  
  .animate-float-big-2 {
    animation: float-big-2 10s ease-in-out infinite 1s;
  }
  
  .animate-float-big-3 {
    animation: float-big-3 12s ease-in-out infinite 2s;
  }
  
  .animate-wave-1 {
    animation: wave-1 6s ease-in-out infinite;
  }
  
  .animate-wave-2 {
    animation: wave-2 8s ease-in-out infinite 1.5s;
  }
  
  .animate-spin-wave {
    animation: spin-wave 4s ease-in-out infinite;
  }
  
  .animate-glow-pulse {
    animation: glow-pulse 3s ease-in-out infinite;
  }
  
  .animate-glow-pulse-2 {
    animation: glow-pulse-2 2.5s ease-in-out infinite 0.5s;
  }
  
  .animate-glow-pulse-3 {
    animation: glow-pulse-3 3.5s ease-in-out infinite 1s;
  }
  
  .animate-sparkle-1 {
    animation: sparkle-1 4s ease-in-out infinite;
  }
  
  .animate-sparkle-2 {
    animation: sparkle-2 5s ease-in-out infinite 1.5s;
  }
  
  .animate-sparkle-3 {
    animation: sparkle-3 4.5s ease-in-out infinite 2s;
  }
  
  .animate-fade-in-up {
    animation: fade-in-up 0.4s ease-out 0.1s both;
  }
  
  .animate-fade-in-up-delay {
    animation: fade-in-up 0.4s ease-out 0.2s both;
  }
  
  .animate-fade-in-up-delay-2 {
    animation: fade-in-up 0.4s ease-out 0.3s both;
  }

  /* Professional typography enhancements */
  h1 {
    text-rendering: optimizeLegibility;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }
</style>