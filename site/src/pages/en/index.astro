---
import Layout from '../../layouts/Layout.astro'
import Hero from '../../components/Hero.astro'
import AdSense from '../../components/AdSense.astro'
import ArticleCard from '../../components/ArticleCard.astro'
import SearchFilter from '../../components/SearchFilter.astro'
import { getArticles, type Article } from '../../lib/sanity'

let articles: Article[] = []
try {
  articles = await getArticles('en')
} catch (error) {
  console.error('Failed to fetch English articles:', error)
}
---

<Layout 
  title="Travel Blog - Japan Travel Stories" 
  description="Multilingual travel blog featuring stories from across Japan. Discover hidden gems and must-visit destinations."
  lang="en"
>
  <!-- Hero Section -->
  <Hero lang="en" />

  <div class="max-w-7xl mx-auto px-4 py-16 space-y-16">
    <!-- Search and Filter Section -->
    <SearchFilter lang="en" />
    
    <!-- Articles Section -->
    <section id="articles" class="relative">
      
      {articles.length === 0 ? (
        <div class="text-center py-16 bg-white rounded-2xl shadow-lg border border-gray-100">
          <div class="text-6xl mb-4">üìù</div>
          <p class="text-gray-500 text-xl mb-2">No English articles yet</p>
          <p class="text-gray-400">Create your first English article in Sanity Studio</p>
        </div>
      ) : (
        <div class="columns-1 sm:columns-2 lg:columns-3 gap-6">
          {articles.map((article) => (
            <ArticleCard article={article} lang="en" />
          ))}
        </div>
      )}
    </section>

    <!-- Google AdSense -->
    <AdSense 
      slot="homepage-bottom"
      format="banner"
      lang="en"
      className="mt-16"
    />
  </div>
</Layout>

<style>
  .line-clamp-3 {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
</style>